!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("rxjs/BehaviorSubject"),require("rxjs/Observable"),require("rxjs/Subject"),require("rxjs/add/observable/of"),require("rxjs/add/observable/interval"),require("rxjs/add/operator/switchMap"),require("rxjs/add/operator/finally"),require("rxjs/add/operator/take"),require("rxjs/add/operator/takeWhile"),require("rxjs/add/operator/do"),require("@angular/animations"),require("rxjs/add/observable/fromEvent"),require("rxjs/add/observable/from"),require("rxjs/add/operator/map")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common","rxjs/BehaviorSubject","rxjs/Observable","rxjs/Subject","rxjs/add/observable/of","rxjs/add/observable/interval","rxjs/add/operator/switchMap","rxjs/add/operator/finally","rxjs/add/operator/take","rxjs/add/operator/takeWhile","rxjs/add/operator/do","@angular/animations","rxjs/add/observable/fromEvent","rxjs/add/observable/from","rxjs/add/operator/map"],t):t(e.ngGallery=e.ngGallery||{},e.ng.core,e.ng.common,e.Rx,e.Rx,e.Rx,e.Rx.Observable,e.Rx.Observable,e.Rx.Observable.prototype,e.Rx.Observable.prototype,e.Rx.Observable.prototype,e.Rx.Observable.prototype,e.Rx.Observable.prototype,e.ng.common)}(this,function(e,t,r,n,o,a,s,i,l,c,p,u,y,g){"use strict";function h(e,t,r){if(void 0===r&&(r=void 0),!e||!t)return r;for(var n=t.split("."),o=e,a=0;a<n.length;a--){if(!o[n[a]])return r;o=o[n[a]]}return o||r}function f(e){return new v(e)}var d={images:void 0,prevIndex:0,currIndex:0,hasNext:void 0,hasPrev:void 0,active:!1},m={style:{background:"#121519",width:"900px",height:"500px"},animation:"fade",loader:{width:"50px",height:"50px",position:"center",icon:"oval"},description:{position:"bottom",overlay:!1,text:!0,counter:!0,style:{color:"red"}},bullets:!1,player:{autoplay:!1,speed:3e3},thumbnails:{width:120,height:90,position:"left",space:30}},v=function(){function e(e){var t=this;this.config=m,this.state=new n.BehaviorSubject(d),this.config=Object.assign({},m,e),this.player=new a.Subject,this.player.switchMap(function(e){return e?t.playerEngine(e):o.Observable.of(null)}).subscribe()}return e.prototype.load=function(e){this.state.next({images:e,currIndex:0,hasNext:e.length>1,hasPrev:!1,active:!1})},e.prototype.set=function(e){var t=this.state.getValue();this.state.next(Object.assign({},t,{prevIndex:t.currIndex,currIndex:e,hasNext:e<h(t,"images.length",0)-1,hasPrev:e>0,active:!0}))},e.prototype.next=function(){var e=this.state.getValue();if(e.hasNext){var t=(e.currIndex||0)+1;this.set(t)}else this.set(0)},e.prototype.prev=function(){var e=this.state.getValue();if(e.hasPrev){var t=(e.currIndex||0)-1;this.set(t)}else this.set(h(e,"images.length",0)-1)},e.prototype.close=function(){var e=this.state.getValue();this.state.next(Object.assign({},e,{active:!1,play:!1})),this.stop()},e.prototype.reset=function(){this.state.next(d),this.stop()},e.prototype.play=function(e){var t=e||h(this.config,"player.speed",0)||2e3,r=this.state.getValue();this.state.next(Object.assign({},r,{play:!0,active:!0})),this.player.next(t)},e.prototype.stop=function(){this.player.next(0)},e.prototype.playerEngine=function(e){var t=this;return o.Observable.interval(e).takeWhile(function(){return t.state.getValue().play||!1}).do(function(){return t.next()}).finally(function(){return t.state.next(Object.assign({},t.state.getValue(),{play:!1}))})},e}();v.decorators=[{type:t.Injectable}],v.ctorParameters=function(){return[{type:void 0,decorators:[{type:t.Optional}]}]};var b=function(){function e(e){this.gallery=e}return e.prototype.ngOnDestroy=function(){this.gallery.reset()},e}();b.decorators=[{type:t.Component,args:[{selector:"gallery",template:'<gallery-main *ngIf="gallery.state | async as state" [state]="state" [config]="gallery.config"></gallery-main>',changeDetection:t.ChangeDetectionStrategy.OnPush,styleUrls:["./gallery.component.scss"]}]}],b.ctorParameters=function(){return[{type:v}]};var x=function(){function e(e){this.gallery=e}return e}();x.decorators=[{type:t.Component,args:[{selector:"gallery-nav",templateUrl:"./gallery-nav.component.html",styleUrls:["./gallery-nav.component.scss"],changeDetection:t.ChangeDetectionStrategy.OnPush}]}],x.ctorParameters=function(){return[{type:v}]},x.propDecorators={state:[{type:t.Input}]};var S=function(){function e(e,t,r){this.gallery=e,this.el=t,this.renderer=r}return e.prototype.ngOnInit=function(){var e=this;if(this.contStyle=this.getContainerStyle(),this.gallery.config.gestures){if("undefined"==typeof Hammer)throw Error("[NgGallery]: HammerJS is undefined, make sure it is loaded");var t=this.el.nativeElement,r=new Hammer(t);r.on("panstart",function(){e.renderer.removeClass(t,"g-pan-reset")}),r.on("panend",function(){e.renderer.addClass(t,"g-pan-reset")}),r.on("pan",function(r){e.renderer.setStyle(t,"transform","translate3d("+r.deltaX+"px, 0px, 0px)")}),r.on("swipeleft",function(){e.gallery.next()}),r.on("swiperight",function(){e.gallery.prev()})}},e.prototype.translateThumbs=function(){return"translate3d("+-(h(this.state,"currIndex",0)*h(this.config,"width",0)+h(this.config,"width",0)/2)+"px, 0, 0)"},e.prototype.getContainerStyle=function(){var e="top"===this.config.position?0:2;return this.renderer.setStyle(this.el.nativeElement,"order",e),{height:this.config.height+"px",margin:this.config.space+"px"}},e.prototype.getThumbImage=function(e){var t=h(this.state,"images",[])[e]||{};return"url("+(t.thumbnail||t.src)+")"},e}();S.decorators=[{type:t.Component,args:[{selector:"gallery-thumb",templateUrl:"./gallery-thumb.component.html",styleUrls:["./gallery-thumb.component.scss"],changeDetection:t.ChangeDetectionStrategy.OnPush}]}],S.ctorParameters=function(){return[{type:v},{type:t.ElementRef},{type:t.Renderer2}]},S.propDecorators={state:[{type:t.Input}],config:[{type:t.Input}]};var I=function(){function e(e,t){this.el=e,this.renderer=t}return e.prototype.ngOnInit=function(){var e=this.el.nativeElement;this.config.overlay&&this.renderer.setStyle(e,"position","absolute"),"top"===this.config.position?(this.renderer.setStyle(e,"order",0),this.renderer.setStyle(e,"top",0),this.renderer.setStyle(e,"bottom","unset")):(this.renderer.setStyle(e,"order",2),this.renderer.setStyle(e,"top","unset"),this.renderer.setStyle(e,"bottom",0))},e}();I.decorators=[{type:t.Component,args:[{selector:"gallery-text",templateUrl:"./gallery-text.component.html",styleUrls:["./gallery-text.component.scss"],changeDetection:t.ChangeDetectionStrategy.OnPush}]}],I.ctorParameters=function(){return[{type:t.ElementRef},{type:t.Renderer2}]},I.propDecorators={state:[{type:t.Input}],config:[{type:t.Input}]};var j=[g.trigger("imgAnimate",[g.state("fade",g.style({opacity:1})),g.transition("none => fade",[g.style({opacity:0}),g.animate("0.5s ease-in")])])],w=function(){function e(e,t,r){this.gallery=e,this.el=t,this.renderer=r}return e.prototype.ngOnInit=function(){var e=this;if(this.config.gestures){if("undefined"==typeof Hammer)throw Error("[NgGallery]: HammerJS is undefined, make sure it is loaded");var t=this.el.nativeElement,r=new Hammer(t);r.on("panstart",function(){e.renderer.removeClass(t,"g-pan-reset")}),r.on("panend",function(){e.renderer.addClass(t,"g-pan-reset")}),r.on("pan",function(r){e.renderer.setStyle(t,"transform","translate3d("+r.deltaX+"px, 0px, 0px)")}),r.on("swipeleft",function(){e.gallery.next()}),r.on("swiperight",function(){e.gallery.prev()})}},e.prototype.imageLoad=function(e){if(this.loading=!e,e)switch(this.config.animation){case"fade":this.animate="fade";break;default:this.animate="none"}else this.animate="none"},e}();w.decorators=[{type:t.Component,args:[{selector:"gallery-image",templateUrl:"./gallery-image.component.html",styleUrls:["./gallery-image.component.scss"],changeDetection:t.ChangeDetectionStrategy.OnPush,animations:j}]}],w.ctorParameters=function(){return[{type:v},{type:t.ElementRef},{type:t.Renderer2}]},w.propDecorators={state:[{type:t.Input}],config:[{type:t.Input}]};var O=function(){function e(e){this.gallery=e}return e.prototype.ngOnInit=function(){this.icon=this.getIcon(),this.styles=this.getStyle()},e.prototype.getIcon=function(){switch(this.config.icon){case"puff":return"https://cdn.rawgit.com/SamHerbert/SVG-Loaders/75b65ef5/svg-loaders/puff.svg";case"spinning-circles":return"https://cdn.rawgit.com/SamHerbert/SVG-Loaders/75b65ef5/svg-loaders/ball-triangle.svg";case"three-dots":return"https://cdn.rawgit.com/SamHerbert/SVG-Loaders/75b65ef5/svg-loaders/three-dots.svg";case"oval":return"https://cdn.rawgit.com/SamHerbert/SVG-Loaders/75b65ef5/svg-loaders/oval.svg";case"ball-triangle":return"https://cdn.rawgit.com/SamHerbert/SVG-Loaders/75b65ef5/svg-loaders/ball-triangle.svg";case"bars":return"https://cdn.rawgit.com/SamHerbert/SVG-Loaders/75b65ef5/svg-loaders/bars.svg";case"tail-spin":return"https://cdn.rawgit.com/SamHerbert/SVG-Loaders/75b65ef5/svg-loaders/tail-spin.svg";default:return this.config.icon}},e.prototype.getStyle=function(){switch(this.config.position){case"topLeft":return{"align-items":"flex-start","justify-content":"flex-start"};case"topRight":return{"align-items":"flex-start","justify-content":"flex-end"};case"bottomLeft":return{"align-items":"flex-end","justify-content":"flex-start"};case"bottomRight":return{"align-items":"flex-end","justify-content":"flex-end"};default:return{"align-items":"center","justify-content":"center"}}},e}();O.decorators=[{type:t.Component,args:[{selector:"gallery-loader",templateUrl:"./gallery-loader.component.html",styleUrls:["./gallery-loader.component.scss"],changeDetection:t.ChangeDetectionStrategy.OnPush}]}],O.ctorParameters=function(){return[{type:v}]},O.propDecorators={config:[{type:t.Input}]};var D=function(){function e(e){this.gallery=e,this.closeButton=!0}return e.prototype.keyboardInput=function(e){if(this.gallery.state.getValue().active)switch(e.stopPropagation(),e.keyCode){case 37:this.gallery.prev();break;case 39:case 13:this.gallery.next();break;case 27:this.gallery.close();break;default:return}},e.prototype.ngOnDestroy=function(){this.gallery.reset()},e}();D.decorators=[{type:t.Component,args:[{selector:"gallery-modal",templateUrl:"./gallery-modal.component.html",styleUrls:["./gallery-modal.component.scss"],changeDetection:t.ChangeDetectionStrategy.OnPush,animations:[g.trigger("popup",[g.state("in",g.style({opacity:.8,transform:"scale(0.2) translate3d(0, 100px, 0)"})),g.transition("void => *",[g.style({opacity:.8,transform:"scale(0.2) translate3d(0, 100px, 0)"}),g.animate(300)]),g.transition("* => void",[g.animate(300,g.style({opacity:1,transform:"scale(1)  translate3d(0, 0, 0)"}))])])]}]}],D.ctorParameters=function(){return[{type:v}]},D.propDecorators={closeButton:[{type:t.Input}],keyboardInput:[{type:t.HostListener,args:["body:keydown",["$event"]]}]};var E=function(){function e(e,t,r){this.gallery=e,this.renderer=t,this.el=r}return e.prototype.ngOnInit=function(){if(this.config.position){var e=void 0,t=void 0,r=void 0,n="unset",o="unset";switch(this.config.position){case"bottom":e="row",r="auto",t="100%","unset",o="0";break;case"left":e="column",t="auto",r="100%";break;case"right":t="auto",r="100%",e="column",n="0";break;default:e="row",r="auto",t="100%"}this.renderer.setStyle(this.el.nativeElement,"right",n),this.renderer.setStyle(this.el.nativeElement,"bottom",o),this.renderer.setStyle(this.el.nativeElement,"width",t),this.renderer.setStyle(this.el.nativeElement,"height",r),this.renderer.setStyle(this.el.nativeElement,"flex-direction",e)}},e}();E.decorators=[{type:t.Component,args:[{selector:"gallery-bullets",templateUrl:"./gallery-bullets.component.html",styleUrls:["./gallery-bullets.component.scss"],changeDetection:t.ChangeDetectionStrategy.OnPush}]}],E.ctorParameters=function(){return[{type:v},{type:t.Renderer2},{type:t.ElementRef}]},E.propDecorators={state:[{type:t.Input}],config:[{type:t.Input}]};var P=function(){function e(e){this.gallery=e}return e.prototype.ngOnInit=function(){this.config.autoplay&&this.gallery.play()},e}();P.decorators=[{type:t.Component,args:[{selector:"gallery-player",templateUrl:"./gallery-player.component.html",styleUrls:["./gallery-player.component.scss"],changeDetection:t.ChangeDetectionStrategy.OnPush}]}],P.ctorParameters=function(){return[{type:v}]},P.propDecorators={config:[{type:t.Input}],state:[{type:t.Input}]};var k=function(){function e(e){this.gallery=e}return e.prototype.ngOnInit=function(){var e=this.config.thumbnails?this.config.thumbnails.position:0;this.thumbDirection="left"===e||"right"===e?"row":"column"},e}();k.decorators=[{type:t.Component,args:[{selector:"gallery-main",templateUrl:"./gallery-main.component.html",styleUrls:["./gallery-main.component.scss"],changeDetection:t.ChangeDetectionStrategy.OnPush,encapsulation:t.ViewEncapsulation.None}]}],k.ctorParameters=function(){return[{type:v}]},k.propDecorators={state:[{type:t.Input}],config:[{type:t.Input}]};var C=function(){function e(e,t,r){this.el=e,this.renderer=t,this.gallery=r,this.srcList=[]}return e.prototype.pluck=function(e,t){for(var r=[],n=e.length;n--;)r.push(e[n][t]);return r.sort()},e.prototype.isEqual=function(e,t){if(e.length!==t.length)return!1;for(var r=e.length;r--;)if(e[r]!==t[r])return!1;return!0},e.prototype.ngOnInit=function(){var e=this,t=this.el.nativeElement,r=function(){if(t&&(!e.content||e.content!==t.innerText)){e.content=t.innerText;var r=[],n=e.gallerize?t.querySelectorAll(e.gallerize):t.querySelectorAll("img");if(n&&n.length){var a=e.pluck(n,"src");if(e.isEqual(e.srcList,a))return;e.srcList=a,o.Observable.from(n).map(function(t,n){e.renderer.setStyle(t,"cursor","pointer"),e.renderer.setProperty(t,"onclick",function(){e.gallery.set(n)}),r.push({src:t.src,text:t.alt})}).finally(function(){return e.gallery.load(r)}).subscribe()}}},n=new MutationObserver(r),a={subtree:!0,childList:!0};n.observe(t,a),r()},e}();C.decorators=[{type:t.Directive,args:[{selector:"[gallerize]"}]}],C.ctorParameters=function(){return[{type:t.ElementRef},{type:t.Renderer2},{type:v}]},C.propDecorators={gallerize:[{type:t.Input}]};var R=function(){function e(e,r){var n=this;this.el=e,this.renderer=r,this.lazyWorker=new a.Subject,this.lazyLoad=new t.EventEmitter(!1),this.lazyWorker.switchMap(function(e){return o.Observable.of(e)}).subscribe(function(e){e?(n.renderer.setProperty(n.el.nativeElement,"src",e),n.lazyLoad.emit(!0)):n.lazyLoad.emit(!1)})}return Object.defineProperty(e.prototype,"lazyImage",{set:function(e){this.getImage(e)},enumerable:!0,configurable:!0}),e.prototype.getImage=function(e){var t=this;this.lazyWorker.next("");var r=this.renderer.createElement("img");r.src=e,r.onload=function(){t.lazyWorker.next(e)},r.onerror=function(e){console.error("[GalleryLazyDirective]:",e),t.lazyWorker.next("")}},e}();R.decorators=[{type:t.Directive,args:[{selector:"[lazyImage]"}]}],R.ctorParameters=function(){return[{type:t.ElementRef},{type:t.Renderer2}]},R.propDecorators={lazyImage:[{type:t.Input,args:["lazyImage"]}],lazyLoad:[{type:t.Output}]};var q=function(){function e(e,r,n){this.gallery=e,this.el=r,this.renderer=n,this.tapClick=new t.EventEmitter}return e.prototype.ngOnInit=function(){this.setTapEvent()},e.prototype.setTapEvent=function(){var e=this;if(this.gallery.config.gestures){if("undefined"==typeof Hammer)throw Error("[NgGallery]: HammerJS is undefined, make sure it is loaded");if("undefined"!=typeof Hammer){new Hammer(this.el.nativeElement).on("tap",function(){e.tapClick.emit()})}}else this.renderer.setProperty(this.el.nativeElement,"onclick",function(){e.tapClick.emit()})},e}();q.decorators=[{type:t.Directive,args:[{selector:"[tap]"}]}],q.ctorParameters=function(){return[{type:v},{type:t.ElementRef},{type:t.Renderer2}]},q.propDecorators={tap:[{type:t.Input}],tapClick:[{type:t.Output}]};var L=new t.InjectionToken("config"),U=function(){function e(){}return e.forRoot=function(t){return{ngModule:e,providers:[{provide:L,useValue:t},{provide:v,useFactory:f,deps:[L]}]}},e}();U.decorators=[{type:t.NgModule,args:[{imports:[r.CommonModule],declarations:[b,x,S,C,I,w,O,D,E,P,k,q,R],exports:[b,C,D]}]}],U.ctorParameters=function(){return[]},e.GalleryModule=U,e.GalleryService=v,Object.defineProperty(e,"__esModule",{value:!0})});
